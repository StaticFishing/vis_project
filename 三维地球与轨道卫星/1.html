<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rotating Earth with Country Names</title>
    <style>
        body { margin: 0; }
        canvas { display: block; }
    </style>
</head>
<body>
    <script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/FontLoader.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/geometries/TextBufferGeometry.js"></script>
    <script src="https://github.com/StaticFishing/vis_project"></script>
    <script>
        // 创建场景
        var scene = new THREE.Scene();

        // 创建相机
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        var renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 创建地球几何体
        var geometry = new THREE.SphereGeometry(5, 32, 32);

        // 加载纹理
        var texture = new THREE.TextureLoader().load('https://api.allorigins.win/raw?url=https://www.solarsystemscope.com/textures/download/2k_earth_daymap.jpg');

        // 使用 MeshStandardMaterial 以支持光照
        var material = new THREE.MeshStandardMaterial({ map: texture });
        var earth = new THREE.Mesh(geometry, material);
        scene.add(earth);

        // 添加环境光（提供场景的基础照明）
        var ambientLight = new THREE.AmbientLight(0x404040, 1); // 软的全局光
        scene.add(ambientLight);

        // 创建点光源（为了让地球的纹理显示出来）
        var light = new THREE.PointLight(0xffffff, 1, 100);
        light.position.set(10, 10, 10);  // 点光源的位置
        scene.add(light);

        // 设置相机位置
        camera.position.z = 15;

        // 添加 OrbitControls（允许用户旋转、缩放和移动相机）
        var controls = new THREE.OrbitControls(camera, renderer.domElement);

        // 创建国家名称
        function addCountryLabel(name, lat, lon) {
            // 将纬度、经度转换为球面坐标
            var phi = (lat) * (Math.PI / 180); // 纬度转弧度
            var theta = (lon + 180) * (Math.PI / 180); // 经度转弧度

            var x = 5 * Math.sin(phi) * Math.cos(theta);
            var y = 5 * Math.cos(phi);
            var z = 5 * Math.sin(phi) * Math.sin(theta);

            // 创建文本几何体
            var loader = new THREE.FontLoader();
            loader.load('https://threejs.org/examples/fonts/helvetiker_regular.typeface.json', function (font) {
                var textGeometry = new THREE.TextBufferGeometry(name, {
                    font: font,
                    size: 0.5,
                    height: 0.1
                });

                var textMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
                var textMesh = new THREE.Mesh(textGeometry, textMaterial);
                textMesh.position.set(x, y, z);

                // 调整文字位置，使其不遮挡地球表面
                textMesh.lookAt(camera.position); // 使文字始终朝向相机
                scene.add(textMesh);
            });
        }

        // 添加几个国家的标签（经纬度：纬度, 经度）
        addCountryLabel('USA', 37.7749, -122.4194); // 旧金山，美国
        addCountryLabel('China', 39.9042, 116.4074); // 北京，中国
        addCountryLabel('India', 28.6139, 77.2090); // 新德里，印度
        addCountryLabel('Brazil', -23.5505, -46.6333); // 圣保罗，巴西
        addCountryLabel('Australia', -33.8688, 151.2093); // 悉尼，澳大利亚

        // 动画循环
        function animate() {
            requestAnimationFrame(animate);

            // 让地球自转
            earth.rotation.y += 0.01;

            controls.update(); // 更新控制器
            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>
